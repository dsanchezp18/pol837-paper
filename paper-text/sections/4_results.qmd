---
# Results
suppress-bibliography: true
---

```{r}
#| label: results-setup
#| include: false

# Source the models

source("scripts/r/empirical_analysis.R")

# Load other needed libraries

library(dplyr)
library(marginaleffects)
library(ggplot2)
library(kableExtra)

# Define modelsummary arguments for tables

stars <- c("**" = 0.05,
           "***" = 0.05)

# Do the goodness of fit mapping as a list mapping

gf_map <- list(
  list("raw" = "nobs", "clean" = "N", "fmt" = 0),
  list("raw" = "aic", "clean" = "AIC", "fmt" = 0),
  list("raw" = "rmse", "clean" = "RMSE", "fmt" = 3),
  list("raw" = "FE: canton_dpa", "clean" = "Canton fixed effects", "fmt" = 0),
  list("raw" = "FE: interview_date", "clean" = "Interview date fixed effects", "fmt" = 0)
)

```

# Results

## Baseline specifications

Table 3 shows baseline results of the logit fixed effects estimation of Equation \ref{eqn:logit}, which are the baseline empirical models of the paper. These only include weather variables and canton and interview date fixed effects. The results from these specifications serve as a benchmark for the subsequent models that include additional control variables. Further, models without any type of political behaviour controls leverage a large sample size, as I do not lose any observations due to missing values. I later estimate models with controls to examine the robustness of the baseline results, as well as to improve the precision of the estimates. 

Specification (1) considers only daily minimum temperature as a weather variable, which shows a positive logit coefficient (0.018) not statistically distinguishable from zero at conventional significance levels. Specification (2) only includes maximum daily temperature, which shows a negative logit coefficient (-0.044) that is statistically significant at $p<0.01$. Specification (3) includes my measure of average temperature, again showing no statistically significant relationship between temperature and presidential approval. 

Specification (4) considers the relationship between both minimum and maximum daily temperature variables, to account for the possibility that days with different spreads between minimum and maximum temperature have different effects on individuals. I also include a daily precipitation variable, to account for the possibility that a rainier day may have an additional effect on approval ratings. It is shown that maximum temperature keeps its significance at $p<0.01$ level, while other weather variables remain statistically insignificant at any conventional significance level. It is valuable to note that standard errors for all of my coefficients in this table are not notably large, which suggests that the lack of statistical significance may not be due to a lack of precision. The sign of the coefficients is evidence which supports the hypothesis that voters may commit attribution errors when evaluating politician's performance, and tend to evaluate the president worse in days with higher temperatures, as per my hypothesis of mood misattribution.

Figure 3 shows the marginal effects plot of maximum temperature on presidential approval from Specification (2). The plot shows that the marginal probability of presidential approval decreases as maximum temperature increases. At about 20°C of maximum daily temperatures, an additional degree makes survey respondents one percent point less likely to approve of the president. At the highest maximum temperature, which is about 34°C, an additional degree (a warmer day) makes survey respondents about 1.25 percent points less likely to approve of the president. These translate to an average marginal effect of -1.0%, as it can be seen in Table A.1 in the Appendix, which presents average marginal effects for all models presented in this section. 

```{r}
#| label: results-baseline-models
#| output: asis

# Define the coefficient names

coefficients_baseline_models <- c(
  "min_temperature" = "Min. temperature (\u00B0C)",
  "max_temperature" = "Max. temperature (\u00B0C)",
  "avg_temperature" = "Avg. temperature (\u00B0C)")

# Add notes as a list

notes_baseline_models <- list(
  "Note: Baseline models explaining presidential approval through daily weather variables and canton and interview date fixed effects. Standard errors shown in parentheses are clustered by canton.",
  "***p<0.01, **p<0.05"
)

# Use modelsummary to create the table

modelsummary(simple_models,
             coef_map = coefficients_baseline_models,
             stars = stars,
             output = "latex",
             estimate = "{estimate}{stars}",
             booktabs = TRUE,
             align = "lrrrr", 
             threeparttable = TRUE,
             title = "Logit coefficients for baseline specifications",
             vcov = ~ canton_dpa,
             notes = notes_baseline_models,
             gof_map = gf_map) %>%
kable_styling(latex_options = "hold_position")
```
```{r}
#| label: partial-effects-plot
#| fig-cap: "Marginal Effects of Max. Temperature on Presidential Approval"

plot_slopes(simple_model2, 
            variables = "max_temperature", 
            condition = "max_temperature") +
  theme_minimal() +
  labs(x = "Max. Temperature (\u00B0C)",
       y = "Marginal Probability of Presidential Approval") +
  scale_y_continuous(labels = scales::percent_format()) +
  theme(panel.grid.major = element_line(linetype = "dashed", linewidth = 0.3),
        panel.grid.minor = element_line(linetype = "dashed", linewidth = 0.3),
        axis.text.x = element_text(color = "black"),
        text = element_text(family = 'serif', color = "black"),
        plot.background = element_rect(fill = "white", colour = "white"),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 1, linetype = "solid"),
        plot.caption = element_text(hjust = 0))
```
## Controlling for political behaviour

\renewcommand{\arraystretch}{0.5}

```{r}
#| label: results-political-behaviour
#| output: asis

# Coefficient names

coefficients_controls <- c(
  "min_temperature" = "Min. temperature (\u00B0C)",
  "max_temperature" = "Max. temperature (\u00B0C)",
  "avg_temperature" = "Avg. temperature (\u00B0C)",
  "precipitation" = "Precipitation (mm)",
  "sexFemale" = "Female",
  "age" = "Age",
  "ethnicityBlanca" = "White (ref. Mestizo)",
  "ethnicityIndígena" = "Indigenous",
  "ethnicityNegra" = "Black",
  "ethnicityMulata" = "Mulatto",
  "ethnicityOtra" = "Other ethnicity",
  "urban_ruralRural" = "Rural area",
  "non_religiousReligious" = "Religious",
  "civil_statusMarried/Common Law" = "Married (ref. single)",
  "civil_statusDivorced/Separated/Widowed" = "Divorced/Separated/Widowed",
  "educationSecondary" = "Secondary education (ref. Primary)",
  "educationSuperior" = "Higher education",
  "labour_marketNot in Labour Force" = "Not in labour force",
  "labour_marketUnemployed" = "Unemployed",
  "personal_econ_situationWorse" = "Perceived worse personal economy",
  "country_econ_situationWorse" = "Perceived worse country economy",
  "incumbent_voteIncumbent" = "Voted for incumbent",
  "ideology" = "Ideology score (0-10)",
  "democracy_supportSupports" = "Supports democracy",
  "political_pride" = "Political pride score (0-7)",
  "external_efficacy" = "External efficacy score (0-7)",
  "internal_efficacy" = "Internal efficacy score (0-7)",
  "corruption_perceptionCorrupt" = "Perceives corruption",
  "corruption_toleranceTolerant" = "Tolerates bribes",
  "confidence_police" = "Trust in police score (0-7)",
  "confidence_local_gov" = "Trust in local gov. (0-7)"
)

# Notes for the table

notes_control_models <- list(
  "Note: Models explaining presidential approval through daily weather variables and controls. Standard errors shown in parentheses are clustered by canton.",
  "***p<0.01, **p<0.05."
)

# Use modelsummary to create the table

modelsummary(models_controls,
             gof_map = gf_map,
             coef_map = coefficients_controls,
             stars = stars,
             estimate = "{estimate}{stars}",
             booktabs = TRUE,
             align = "lrrrr", 
             threeparttable = TRUE,
             title = "Logit coefficients for specifications with controls",
             vcov = ~ canton_dpa,
             notes = notes_control_models,
             output = "latex",
             threeparttable = TRUE,
             longtable = T) %>%
kable_styling(latex_options = c("hold_position", "repeat_header"), font_size = 11)
```

Table 4 shows the results of the logit fixed effects estimation of Equation \ref{eqn:baseline} with additional political behaviour controls. I control for sex, age, urban status, labour market status, education, ethnicity, and civil status. Personal perceptions of both personal and country economic situations are included too. The country's economic situation is particularly informative, given that it partials out the relationship of economic voting from the weather variables.

I also control for having voted for the incumbent and political ideology. Finally, I include variables for democracy support, political pride, corruption perceptions, corruption tolerance (bribes), efficiency and trust scores for police and local government. A disadvantage to these models is that lose a large amount of observations, since not all questions are asked consistently across survey rounds. I completely lose the 2021 wave due to a lack of the most fundamental controls, which were not asked due to the restricted survey design which was adopted to the COVID-19 pandemic.

Specifications (1) through (4) are the same as in Table 1, but with the addition of controls. Results show that the sign and significance of daily maximum temperature remain unchanged, showing that the relationship between temperature and presidential approval is robust to the inclusion of these controls. Further, I also find a negative and statistically significant relationship between presidential approval and my measure of average temperature in specification (3), which was not present in the baseline models.

With regard to the political behaviour controls, I find that the relationship between presidential approval and my controls is consistent with the literature. Those who perceive the country's economic situation as worse are less likely to approve of the president, as are those who perceive the country as more corrupt and those more tolerant to bribes. The former result is consistent with most of the literature on economic voting. Further, I find that support for democracy, police, and political pride are positively related to presidential approval, while the opposite is true for those who are more right-wing and those who are unemployed. External efficiency is positively related to approval. Naturally, having voted for the incumbent greatly explains approval as well. No demographic or socioeconomic variables are statistically significant at any conventional significance level other than sex (female).

```{r}
#| label: partial-effects-plot-controls
#| fig-cap: "Marginal Effects of Max. Temperature on Presidential Approval with Controls"
#| fig-cap-location: top
#| fig-width: 6.7
#| fig-height: 4

plot_slopes(model2_controls, variables = "max_temperature", condition = "max_temperature") + 
  theme_minimal() +
  labs(x = "Max. Temperature (\u00B0C)",
       y = "Marginal Probability of Presidential Approval") +
  scale_y_continuous(labels = scales::percent_format()) +
  theme(panel.grid.major = element_line(linetype = "dashed", linewidth = 0.3),
        panel.grid.minor = element_line(linetype = "dashed", linewidth = 0.3),
        axis.text.x = element_text(color = "black"),
        text = element_text(family = 'serif', color = "black"),
        plot.background = element_rect(fill = "white", colour = "white"),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 1, linetype = "solid"),
        plot.caption = element_text(hjust = 0))
```

Figure 4 above shows the marginal effects plot of maximum temperature on presidential approval from Specification (4) with controls. Comparing to Figure 3, it is shown that the inclusion of controls does not change the decreasing marginal probability of presidential approval across maximum temperature. The relationship is in fact increased after controls are included. The average marginal effect of maximum temperature on presidential approval is -2.0%, as it can be seen in Table A.2 in the Appendix. 

In models not shown here, I tested for the inclusion of non-linearities in daily temperature effects. I find thatquadratic, cubic and quartic forms are not statistically significant, however, natural logarithm transformations of temperature are. This would suggest that the relationship between temperature and presidential approval is increasing, but at a decreasing rate. However, the inclusion of these transformations does not change the sign or significance of the coefficients of the other variables in the model.
